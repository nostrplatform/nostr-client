import{g as E,j as s,E as V,F as S,X as w,Y as z,A as i,l as j,m as b,z as y,W as v,r as C}from"./index-BETSscnm.js";import{r as N,L as k}from"./react-stuff-BXf_FtOc.js";import{n as f}from"./nostr-dev-kit-Ci8rOtvv.js";import{u as D}from"./index-B2SqHZ3w.js";import{S as A,B as T,C as H}from"./skeleton-CMxO_lKE.js";import{T as M}from"./x-QsXYDViR.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=E("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),F=({open:a,onOpenChange:n,definition:e,award:r})=>{const{profile:m,status:x}=D({pubkey:(e==null?void 0:e.pubkey)??""}),{profile:l,status:u}=D({pubkey:(r==null?void 0:r.awarder)??""}),{profile:c,status:t}=D({pubkey:(r==null?void 0:r.recipient)??""}),d=N.useMemo(()=>{try{return e!=null&&e.pubkey?f.npubEncode(e.pubkey):""}catch{return""}},[e==null?void 0:e.pubkey]),p=N.useMemo(()=>{try{return r!=null&&r.awarder?f.npubEncode(r.awarder):""}catch{return""}},[r==null?void 0:r.awarder]),h=N.useMemo(()=>{try{return r!=null&&r.recipient?f.npubEncode(r.recipient):""}catch{return""}},[r==null?void 0:r.recipient]);if(!e)return null;const g=e.event.tags.filter(o=>o.length>=3&&o[0]==="t"&&o[1]==="hashtag").map(o=>o[2]);return s.jsx(V,{open:a,onOpenChange:n,children:s.jsxs(S,{className:"sm:max-w-[550px] overflow-y-auto max-h-[85vh]",children:[s.jsx(w,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:s.jsx(z,{className:"text-xl font-bold",children:e.name||"Badge Details"})}),s.jsxs("div",{className:"flex flex-col gap-6 py-4",children:[(e.image||e.thumb)&&s.jsx("div",{className:"flex justify-center",children:s.jsx("div",{className:"w-32 h-32 rounded-lg overflow-hidden border border-border bg-muted/30 p-2",children:s.jsx("img",{src:e.image||e.thumb,alt:e.name||"Badge image",className:"w-full h-full object-contain"})})}),s.jsxs("div",{className:"space-y-4",children:[e.description&&s.jsx("div",{className:"text-sm leading-relaxed",children:e.description}),s.jsxs("div",{className:"flex items-center gap-2 text-sm border-t border-border pt-4",children:[s.jsx("span",{className:"text-muted-foreground min-w-[80px]",children:"Created by:"}),x==="loading"?s.jsx(A,{className:"h-6 w-32"}):s.jsxs(k,{to:`/profile/${d}`,className:"flex items-center gap-2 hover:underline text-primary",children:[s.jsxs(i,{className:"h-5 w-5",children:[s.jsx(j,{src:m==null?void 0:m.image}),s.jsx(b,{className:"text-xs",children:s.jsx(y,{size:10})})]}),s.jsx("span",{children:(m==null?void 0:m.displayName)||(m==null?void 0:m.name)||v(d,12)})]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm border-t border-border pt-4",children:[s.jsx("span",{className:"text-muted-foreground min-w-[80px]",children:"Unique ID:"}),s.jsx("code",{className:"bg-muted px-1.5 py-0.5 rounded text-xs",children:e.d})]}),g&&g.length>0&&s.jsxs("div",{className:"space-y-2 border-t border-border pt-4",children:[s.jsxs("div",{className:"flex items-center gap-1.5 text-sm",children:[s.jsx(_,{size:14,className:"text-muted-foreground"}),s.jsx("span",{className:"text-muted-foreground",children:"Hashtags:"})]}),s.jsx("div",{className:"flex flex-wrap gap-2",children:g.map((o,I)=>s.jsxs(T,{variant:"secondary",className:"text-xs",children:["#",o]},I))})]}),e.tags&&e.tags.length>0&&s.jsxs("div",{className:"space-y-2 border-t border-border pt-4",children:[s.jsxs("div",{className:"flex items-center gap-1.5 text-sm",children:[s.jsx(M,{size:14,className:"text-muted-foreground"}),s.jsx("span",{className:"text-muted-foreground",children:"Tags:"})]}),s.jsx("div",{className:"flex flex-wrap gap-2",children:e.tags.map((o,I)=>s.jsxs(T,{variant:"outline",className:"text-xs",children:[s.jsxs("span",{className:"font-semibold mr-1",children:[o.name,":"]})," ",o.value]},I))})]}),r&&s.jsxs("div",{className:"space-y-4 border-t border-border pt-4",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(H,{size:14,className:"text-muted-foreground"}),s.jsx("span",{className:"text-muted-foreground",children:"Awarded on:"}),s.jsx("span",{children:new Date(r.awardedAt*1e3).toLocaleDateString()})]}),s.jsxs("div",{className:"flex flex-col gap-3 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-muted-foreground min-w-[80px]",children:"Awarded by:"}),u==="loading"?s.jsx(A,{className:"h-6 w-32"}):s.jsxs(k,{to:`/profile/${p}`,className:"flex items-center gap-2 hover:underline text-primary",children:[s.jsxs(i,{className:"h-5 w-5",children:[s.jsx(j,{src:l==null?void 0:l.image}),s.jsx(b,{className:"text-xs",children:s.jsx(y,{size:10})})]}),s.jsx("span",{children:(l==null?void 0:l.displayName)||(l==null?void 0:l.name)||v(p,12)})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-muted-foreground min-w-[80px]",children:"Awarded to:"}),t==="loading"?s.jsx(A,{className:"h-6 w-32"}):s.jsxs(k,{to:`/profile/${h}`,className:"flex items-center gap-2 hover:underline text-primary",children:[s.jsxs(i,{className:"h-5 w-5",children:[s.jsx(j,{src:c==null?void 0:c.image}),s.jsx(b,{className:"text-xs",children:s.jsx(y,{size:10})})]}),s.jsx("span",{children:(c==null?void 0:c.displayName)||(c==null?void 0:c.name)||v(h,12)})]})]})]})]})]})]})]})})},R=({award:a,perspective:n,definition:e})=>{var h;const[r,m]=N.useState(!1),x=n==="awarder"?a.recipient:a.awarder,{profile:l,status:u}=D({pubkey:x}),c=N.useMemo(()=>{try{return f.npubEncode(x)}catch{return x}},[x]),t=(e==null?void 0:e.name)||((h=a.definitionEventId)==null?void 0:h.split(":")[2])||"Unknown Badge",d=(e==null?void 0:e.thumb)||(e==null?void 0:e.image),p=(l==null?void 0:l.displayName)||(l==null?void 0:l.name)||v(c,15);return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center justify-between gap-4 p-3 border border-border rounded-lg bg-card text-card-foreground cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>m(!0),children:[s.jsxs("div",{className:"flex items-center gap-4 overflow-hidden",children:[s.jsxs(i,{className:"w-10 h-10 flex-shrink-0",children:[s.jsx(j,{src:d,alt:t}),s.jsx(b,{children:s.jsx(C,{className:"w-5 h-5 text-muted-foreground"})})]}),s.jsxs("div",{className:"overflow-hidden",children:[s.jsx("p",{className:"font-semibold truncate",children:t}),s.jsxs("div",{className:"text-sm text-muted-foreground truncate flex items-center gap-1",children:[s.jsx("span",{children:n==="awarder"?"To: ":"From: "}),u==="loading"?s.jsx(A,{className:"h-4 w-20 inline-block"}):s.jsxs(k,{to:`/profile/${c}`,className:"hover:underline flex items-center gap-1 text-primary hover:text-primary/80",onClick:g=>g.stopPropagation(),children:[s.jsxs(i,{className:"w-4 h-4",children:[s.jsx(j,{src:l==null?void 0:l.image,alt:p}),s.jsx(b,{className:"text-xs bg-muted text-muted-foreground",children:s.jsx(y,{size:10})})]}),s.jsx("span",{children:p})]})]})]})]}),s.jsx("span",{className:"text-xs text-muted-foreground flex-shrink-0",children:new Date(a.awardedAt*1e3).toLocaleDateString()})]}),s.jsx(F,{open:r,onOpenChange:m,definition:e,award:a,perspective:n})]})},B=30009,L=8,q=a=>{const n=a.tagValue("d");if(a.kind!==B||!n)return null;const e=a.tags.filter(t=>t[0]==="t"&&t.length>=3).map(t=>({name:t[1],value:t[2]})),r=a.tags.filter(t=>t[0]==="t"&&t[1]==="hashtag"&&t.length>=3).map(t=>t[2]),m=a.tags.find(t=>t[0]==="image");let x,l;if(m&&m.length>=3&&m[2]){const t=m[2].split("x");t.length===2&&(x=parseInt(t[0],10)||void 0,l=parseInt(t[1],10)||void 0)}const c=a.tags.filter(t=>t[0]==="thumb").map(t=>{const d={url:t[1]};if(t.length>=3&&t[2]){const p=t[2].split("x");p.length===2&&(d.width=parseInt(p[0],10)||void 0,d.height=parseInt(p[1],10)||void 0)}return d});return{id:a.id,pubkey:a.pubkey,d:n,name:a.tagValue("name")??void 0,description:a.tagValue("description")??void 0,image:a.tagValue("image")??void 0,imageWidth:x,imageHeight:l,thumbs:c.length>0?c:void 0,thumb:a.tagValue("thumb")??void 0,hashtags:r.length>0?r:void 0,tags:e.length>0?e:void 0,event:a}},X=a=>{if(a.kind!==L)return null;const n=a.tags.find(c=>{var t,d;return c[0]==="a"&&((t=c[1])==null?void 0:t.startsWith(`${B}:`))&&((d=c[1])==null?void 0:d.split(":").length)===3}),e=a.tags.find(c=>c[0]==="p"&&c[1]);if(!n||!e)return null;const r=a.tagValue("d"),m=a.tagValue("name"),x=a.tagValue("description"),l=a.tagValue("image"),u=a.tagValue("thumb");return{id:a.id,awarder:a.pubkey,recipient:e[1],definitionEventId:n[1],badgeD:r,badgeName:m,badgeDescription:x,badgeImage:l,badgeThumb:u,awardedAt:a.created_at??0,event:a}};export{R as B,_ as H,q as a,F as b,X as p};

import{j as s,S as p,s as g,A as b,l as f,W as y,u as z,a as R,T as _,P as A,Q as u,V as x}from"./index-BETSscnm.js";import{r as c,L as N}from"./react-stuff-BXf_FtOc.js";import{z as E,k as S}from"./nostr-dev-kit-Ci8rOtvv.js";import{b as h,T as Z,R as F,Z as I}from"./index-zd-tPDC5.js";import"./zustand-B-hWnPoZ.js";import"./textarea-Wl9G6xb5.js";import"./scroll-area-C4yQe26l.js";import"./x-QsXYDViR.js";import"./index-0SbEOFyM.js";const k=({mentionsAndReplies:e})=>e==null?void 0:e.map(a=>s.jsx(s.Fragment,{children:s.jsx("div",{className:"pb-2",children:s.jsx(h,{noteId:a.id})},a.id)})),w=c.memo(({reactions:e})=>{const a=c.useMemo(()=>{const r=new Map;return e==null||e.forEach(t=>{const o=t.getMatchingTags("e");if(o.length>0){const i=o[o.length-1];if(i.length>0){const l=i[1],d=r.get(l)||[];d.push(t),r.set(l,d)}}}),r},[e]);return e===void 0?s.jsx(p,{}):e.length===0?s.jsx("div",{children:"No reactions yet"}):s.jsx(s.Fragment,{children:Array.from(a.keys()).map(r=>{var t;return s.jsx("div",{className:"px-2 pb-2",children:s.jsxs("div",{className:"border rounded-sm shadow-md bg-background transition-colors duration-500 ease-out hover:border-primary/30",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-2 px-2 py-2",children:[s.jsx(Z,{size:18}),(t=a.get(r))==null?void 0:t.map(o=>s.jsx($,{reaction:o},o.id))]}),s.jsx("div",{className:"pb-2",children:s.jsx(h,{noteId:r})})]})},r)})})}),$=c.memo(({reaction:e})=>{var r;const{profile:a}=g(e.pubkey);return s.jsx(N,{to:`/profile/${e.author.npub}`,children:s.jsxs("div",{className:"flex gap-1 items-center",children:[s.jsx(b,{className:"bg-secondary w-5 h-5",children:s.jsx(f,{src:a==null?void 0:a.image,className:"bg-secondary"})}),s.jsxs("p",{className:"text-xs font-light",children:[s.jsx("span",{children:y(((r=a==null?void 0:a.name)==null?void 0:r.toString())||e.author.npub,20)}),s.jsxs("span",{children:[" ",e.content==="+"?"ðŸ‘":e.content]})]})]})})}),M=c.memo(({reposts:e})=>{const a=c.useMemo(()=>{const r=new Map;return e==null||e.forEach(t=>{const o=t.getMatchingTags("e");if(o.length>0){const i=o[o.length-1];if(i.length>0){const l=i[1],d=r.get(l)||[];d.push(t),r.set(l,d)}}}),r},[e]);return e===void 0?s.jsx(p,{}):e.length===0?s.jsx("div",{children:"No reposts yet"}):s.jsx(s.Fragment,{children:Array.from(a.keys()).map(r=>{var t;return s.jsx("div",{className:"px-2 pb-2",children:s.jsxs("div",{className:"border rounded-sm shadow-md bg-background transition-colors duration-500 ease-out hover:border-primary/30",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-2 px-2 py-2",children:[s.jsx(F,{size:18}),(t=a.get(r))==null?void 0:t.map(o=>s.jsx(v,{repost:o},o.id))]}),s.jsx("div",{className:"pb-2",children:s.jsx(h,{noteId:r})})]})},r)})})}),v=c.memo(({repost:e})=>{var r;const{profile:a}=g(e.pubkey);return s.jsx(N,{to:`/profile/${e.author.npub}`,children:s.jsxs("div",{className:"flex gap-1 items-center",children:[s.jsx(b,{className:"bg-secondary w-5 h-5",children:s.jsx(f,{src:a==null?void 0:a.image,className:"bg-secondary"})}),s.jsx("p",{className:"text-xs font-light",children:s.jsx("span",{children:y(((r=a==null?void 0:a.name)==null?void 0:r.toString())||e.author.npub,20)})})]})})}),T=c.memo(({zaps:e})=>{const a=c.useMemo(()=>{const r=new Map;return e==null||e.forEach(t=>{const o=t.getMatchingTags("e");if(o.length>0){const i=o[o.length-1];if(i.length>0){const l=i[1],d=r.get(l)||[];d.push(t),r.set(l,d)}}}),r},[e]);return e===void 0?s.jsx(p,{}):e.length===0?s.jsx("div",{children:"No zaps yet"}):s.jsx(s.Fragment,{children:Array.from(a.keys()).map(r=>{var t;return s.jsx("div",{className:"px-2 pb-2",children:s.jsxs("div",{className:"border rounded-sm shadow-md bg-background transition-colors duration-500 ease-out hover:border-primary/30",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-2 px-2 py-2",children:[s.jsx(I,{size:18}),(t=a.get(r))==null?void 0:t.map(o=>s.jsx(P,{zap:o},o.id))]}),s.jsx("div",{className:"pb-2",children:s.jsx(h,{noteId:r})})]})},r)})})}),P=c.memo(({zap:e})=>{const a=E(e),{profile:r}=g(a==null?void 0:a.zappee),t=c.useMemo(()=>a&&a.zapper?new S({pubkey:a.zapper}).npub:"",[a==null?void 0:a.zapper]);return s.jsx(N,{to:`/profile/${t}`,children:s.jsxs("div",{className:"flex gap-1 items-center",children:[s.jsx(b,{className:"bg-secondary w-5 h-5",children:s.jsx(f,{src:r==null?void 0:r.image,className:"bg-secondary"})}),s.jsxs("p",{className:"text-xs font-light",children:[s.jsxs("span",{className:"font-bold",children:[" ",((a==null?void 0:a.amount)||0)/1e3," sats"]}),s.jsxs("span",{children:[" from ",y(r!=null&&r.name?r.name.toString():t,20)]})]})]})})},(e,a)=>e.zap.id===a.zap.id),L=c.memo(()=>{const{activeUser:e}=z(),a=e?`notifications-${e.pubkey}`:void 0,{createSubscription:r,events:t}=R(a);c.useEffect(()=>{e&&r({filters:[{kinds:[1,6,7,9735],"#p":[e.pubkey],limit:100}]})},[e,r]);const o=c.useMemo(()=>t==null?void 0:t.filter(n=>n.kind===1&&n.pubkey!==(e==null?void 0:e.pubkey)).sort((n,m)=>m.created_at-n.created_at),[t,e==null?void 0:e.pubkey]),i=c.useMemo(()=>t==null?void 0:t.filter(n=>n.kind===6&&n.pubkey!==(e==null?void 0:e.pubkey)).sort((n,m)=>m.created_at-n.created_at),[t,e==null?void 0:e.pubkey]),l=c.useMemo(()=>t==null?void 0:t.filter(n=>n.kind===7&&n.pubkey!==(e==null?void 0:e.pubkey)).sort((n,m)=>m.created_at-n.created_at),[t,e==null?void 0:e.pubkey]),d=c.useMemo(()=>t==null?void 0:t.filter(n=>n.kind===9735&&n.pubkey!==(e==null?void 0:e.pubkey)).sort((n,m)=>m.created_at-n.created_at),[t,e==null?void 0:e.pubkey]),j=c.useMemo(()=>[...o||[],...i||[],...l||[],...d||[]].sort((n,m)=>m.created_at-n.created_at),[o,i,l,d]);return s.jsx("div",{children:s.jsxs(_,{defaultValue:"all",children:[s.jsxs(A,{className:"w-full rounded-none",children:[s.jsx(u,{value:"all",children:"All"}),s.jsx(u,{value:"mentions-replies",children:"Mentions and Replies"}),s.jsx(u,{value:"reposts",children:"Reposts"}),s.jsx(u,{value:"reactions",children:"Reactions"}),s.jsx(u,{value:"zaps",children:"Zaps"})]}),s.jsx(x,{value:"all",children:j==null?void 0:j.map(n=>{switch(n.kind){case 1:return s.jsx(k,{mentionsAndReplies:[n]},n.id);case 6:return s.jsx(M,{reposts:[n]},n.id);case 7:return s.jsx(w,{reactions:[n]},n.id);case 9735:return s.jsx(T,{zaps:[n]},n.id);default:return null}})}),s.jsx(x,{value:"mentions-replies",children:s.jsx(k,{mentionsAndReplies:o})}),s.jsx(x,{value:"reposts",children:s.jsx(M,{reposts:i})}),s.jsx(x,{value:"reactions",children:s.jsx(w,{reactions:l})}),s.jsx(x,{value:"zaps",children:s.jsx(T,{zaps:d})})]})})}),H=()=>{const{activeUser:e}=z();return e===void 0?s.jsx(p,{}):e===null?s.jsx("div",{className:"flex flex-col h-full w-full items-center justify-center",children:s.jsx("h3",{children:"Welcome to Nostr Platform!"})}):s.jsx("div",{className:"h-full w-full overflow-y-auto",children:s.jsx(L,{})})};export{H as NotificationsPage};
